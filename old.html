<!DOCTYPE html>
<html>
  <head>
    <title>Canvas - Trigonometric and Fractal Animation</title>
    <script src="jquery/jquery-1.3.2.min.js" type="text/javascript"></script>
    <script type="text/javascript">
(function($) {
  $.fn.Lorenz = function(userShape, userBG) {
    return this.each(function() {
      var lorenz_i;
      var t = 0;
      var x = 1;
      var y = 1;
      var z = 1;
      var c = this.getContext('2d');

      var draw = function() {
        c.clearRect(0,0,300,300);
        c.save();
        userBG(c);
        c.translate(Math.ceil(x*5)+150,Math.ceil(y*5)+150);
        c.scale(z/20,z/20);
        userShape(c);
        c.restore();
      };

      var calculate = function() {
        t++;
        var h = 0.01;
        var b = 8.0/3.0;
        var s = 10.0;
        var r = 28.0;
        var _x,_y,_z;
        _x = x+h * (s * (y - x));
        _y = y+h * (x * (r - z) - y);
        _z = z+h * ((x * y) - (b * z));
        x = _x;
        y = _y;
        z = _z;
        draw();
      }

      lorenz_i = setInterval(calculate, 25);
    });
  };
  $.fn.Ellipse = function(userShape, userBG, ellipsoid) {
    return this.each(function() {
      ellipsoid = null == ellipsoid ? false : ellipsoid;
      var ellipse_i;
      var t = 0;
      var x = 1;
      var y = 1;
      var z = 1;
      var c = this.getContext('2d');

      var draw = function() {
        c.clearRect(0,0,300,300);
        c.save();
        userBG(c);
        c.translate(Math.ceil(x)+150,Math.ceil(y)+150);
        if (ellipsoid) c.scale(z+0.5,z+0.5);
        userShape(c);
        c.restore();
      };

      var calculate = function() {
        t++;
        x = -Math.sin(t/360 * (Math.PI*2))*125;
        y = Math.cos(t/360 * (Math.PI*2))*50;
        if (ellipsoid) z = Math.round(Math.abs(Math.cos(t/360 * Math.PI))*100)/100;
        draw();
      }

      ellipse_i = setInterval(calculate, 25);
    });
  };
  $.fn.Lissajous = function(userShape, userBG) {
    return this.each(function() {
      var lissajous_i;
      var t = 0;
      var x = 1;
      var y = 1;
      var c = this.getContext('2d');

      var draw = function() {
        c.clearRect(0,0,300,300);
        c.save();
        userBG(c);
        c.translate(Math.ceil(x)+150,Math.ceil(y)+150);
        userShape(c);
        c.restore();
      };

      var calculate = function() {
        t++;
        x = -Math.cos(t/288 * (Math.PI*2))*125;
        y = Math.sin(t/360 * (Math.PI*2))*125;
        draw();
      }

      lissajous_i = setInterval(calculate, 25);
    });
  };
  $.fn.Rose = function(userShape, userBG) {
    return this.each(function() {
      var rose_i;
      var t = 0;
      var x = 1;
      var y = 1;
      var c = this.getContext('2d');

      var draw = function() {
        c.clearRect(0,0,300,300);
        c.save();
        userBG(c);
        c.translate(Math.ceil(x)+150,Math.ceil(y)+150);
        userShape(c);
        c.restore();
      };

      var calculate = function() {
        t++;
        x = Math.sin(2*t/180)*Math.cos(5*t/180)*125;
        y = Math.sin(2*t/180)*Math.sin(5*t/180)*125;
        draw();
      }

      rose_i = setInterval(calculate, 25);
    });
  };
  $.fn.VanDerPol = function(userShape, userBG) {
    return this.each(function() {
      var vanderpol_i;
      var t = 0;
      var x = 1;
      var y = 1;
      var c = this.getContext('2d');

      var draw = function() {
        c.clearRect(0,0,300,300);
        c.save();
        userBG(c);
        c.translate(Math.ceil(x*40)+150,Math.ceil(y*40)+150);
        userShape(c);
        c.restore();
      };

      var calculate = function() {
        t++;
        var h = 0.1;
        var mu = 1.0;
        var _x,_y;
        _x = x+h * y;
        _y = y+h * (-x - mu * (Math.pow(x,2) - 1) * y);
        x = _x;
        y = _y;
        draw();
      }

      vanderpol_i = setInterval(calculate, 25);
    });
  };
  $.fn.Duffing = function(userShape, userBG) {
    return this.each(function() {
      var duffing_i;
      var t = 0.0;
      var x = 0.2;
      var y = -0.3;
      var c = this.getContext('2d');

      var draw = function() {
        c.clearRect(0,0,300,300);
        c.save();
        userBG(c);
        c.translate(Math.ceil(x*60)+150,Math.ceil(y*50)+150);
        userShape(c);
        c.restore();
      };

      var calculate = function() {
        if (t >= 500.0) t = 0.0;
        if (x*60 > 151 || x*60 < -151) x = 0;
        if (y*50 > 151 || y*50 < -151) y = 0;
        else t += 0.1;
        var h = 0.1;
        var a = 0.25;
        var b = 0.3;
        var w = 1;
        var _x,_y;
        _x = x+h * y;
        _y = y+h * (x-Math.pow(x,3)-a*y+b*Math.cos(w*t));
        x = _x;
        y = _y;
        draw();
      }

      duffing_i = setInterval(calculate, 25);
    });
  };
})(jQuery);

$(function() {
  var bg = function(c){
    g = c.createRadialGradient(150,150,0,150,150,150);
    g.addColorStop(0.0,"rgba(255,255,255,1)");
    g.addColorStop(1.0,"rgba(0,0,0,1)");
    c.fillStyle = g;
    c.beginPath();
    c.fillRect(0,0,300,300);
    c.closePath();
  };

  var shape = function(c){
    c.fillStyle = "rgba(255,0,0,1)";
    c.beginPath();
    c.arc(0,0,5,0,Math.PI*2,false);
    c.fill();
    c.closePath();
  };

  $("#lorenz").Lorenz(shape,bg,true);
  $("#ellipse").Ellipse(shape,bg,true);
  $("#lissajous").Lissajous(shape,bg,true);
  $("#rose").Rose(shape,bg,true);
  $("#vanderpol").VanDerPol(shape,bg,true);
  $("#duffing").Duffing(shape,bg,true);
});
    </script>
  </head>
  <body>
    <p>Lorenz Attractor</p>

    <canvas id="lorenz" width="300" height="300" style="border:1px solid black;"></canvas>

    <p>Ellipse/Ellipsoid in Canvas</p>

    <canvas id="ellipse" width="300" height="300" style="border:1px solid black;"></canvas>

    <p>Lissajous Pattern in Canvas</p>

    <canvas id="lissajous" width="300" height="300" style="border:1px solid black;"></canvas>

    <p>Rose Pattern in Canvas</p>

    <canvas id="rose" width="300" height="300" style="border:1px solid black;"></canvas>

    <p>Van der Pol Oscillator</p>

    <canvas id="vanderpol" width="300" height="300" style="border:1px solid black;"></canvas>

    <p>Duffing Attractor</p>

    <canvas id="duffing" width="300" height="300" style="border:1px solid black;"></canvas>
  </body>
</html>
